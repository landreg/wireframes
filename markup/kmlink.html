<head/>
<script>
var kmlinks = [];
function SaveMySelf() {
    try { 
 		window.opener.setkmlinks(kmlinks);
    }
    catch (err) {
		alert("fail" +err.message);
	}
    window.close();
    return false;
}

window.onload=function(){
 
	try{
		kmlinks = window.opener.kmlinks;
		showLinks();
	}
	catch(err){
		alert("could not load exiting links: "+ err.message); 
	}	
	
}
function addLine(kmlink,num){
	document.getElementById("kmlinks").innerHTML += "<p><button onclick='deleteLink(" + num + ")'>Delete </button>" + kmlink.kmlink + "</p>";
}

function showLinks(){
	document.getElementById("kmlinks").innerHTML ="";
    
	if (kmlinks != null)
		for (var x=0;(x<kmlinks.length);x++){
			addLine(kmlinks[x],x);
	}
}

function deleteLink(num){
	kmlinks.splice(num,1);
	showlinks();
}

function addlink(){
		
		var kmlink = {"kmlink":document.getElementById("kmlink").value};
		if (kmlinks.indexOf(kmlink) == -1){
			var num = kmlinks.push(kmlink)-1;
			addLine(kmlink,num);
			document.getElementById("kmlink").value ="";
			document.getElementById("kmlink").focus();
			}
			else{
			alert("duplicate");
			}
			
}

 
	
</script>	

<head>
<body>
<p>KM LINK:<br><input id="kmlink" type="text" ></input><button onclick="addlink()">Add</button></p>
<div id="kmlinks"></div>
<button onclick="SaveMySelf()">Save</button>

</body>