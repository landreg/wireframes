<html>
<head>

<!--
-->
<style>
	.html {
		background: lightblue;
	}
	.json {
		background: pink;
	}
	.hide {
		display:none;
	}
	
</style>
<script src="jmarked.js"       type="text/javascript"></script>
<script src="epiceditor/js/epiceditor.js"       type="text/javascript"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
 
		
<script type="text/javascript">
	var editor;

	function loadEditor(){
		var opts = {
		  container: 'epiceditor',
		  textarea: null,
		  basePath: 'epiceditor',
		  clientSideStorage: true,
		  localStorageName: 'epiceditor',
		  useNativeFullscreen: true,
		  parser:   jmarked,
		  file: {
			name: 'epiceditor',
			defaultContent: '',
			autoSave: 100
		  },
		  theme: {
			base: '/themes/base/epiceditor.css',
			preview: '/themes/preview/preview-dark.css',
			editor: '/themes/editor/epic-dark.css'
		  },
		  button: {
			preview: true,
			fullscreen: true,
			bar: "auto"
		  },
		  focusOnLoad: false,
		  shortcut: {
			modifier: 18,
			fullscreen: 70,
			preview: 80
		  },
		  string: {
			togglePreview: 'Toggle Preview Mode',
			toggleEdit: 'Toggle Edit Mode',
			toggleFullscreen: 'Enter Fullscreen'
		  },
		  autogrow: false
		}
	editor = new EpicEditor(opts);
	editor.load();
	}

	var html;
	var disp;

	function getHTML(){
		editor.preview()
		html = editor.getElement('previewer').body.innerHTML;
		var rstart = html.replace('<div id="epiceditor-preview">',"");
		var rend = rstart.replace(new RegExp('</div>(?!</div>)','g'),"");
		var ehtml1 = rend.replace(new RegExp('\<','g'),"&lt");
		var ehtml2 = ehtml1.replace(new RegExp('\>','g'),"&gt");

		disp = "<pre >" + ehtml2 + "</pre>";
		document.getElementById("html").innerHTML = disp;
		document.getElementById("mhtml").value =  html;
		editor.edit();
	}

		function getJSON(){
		var jsonstart;
		json = '{"article\":{<br/>';
		json += '"_boost": {"name" : "sponsor", "null_value" : 1.0},<br/>';	
		json += '"properties":{}<br/>';		
		json += '}<br/>';
 		document.getElementById("json").innerHTML =  json;
 	}

	function getit(){
		getHTML();
		getJSON();
	
	}
	function rest($method,$url,$data){ 
		xmlhttp=new XMLHttpRequest(); 
		xmlhttp.open($method,$url,true) 
		xmlhttp.send(null); 
		
		if (xmlhttp.status == 200)
			alert("The request succeeded!\n\nThe response representation was:\n\n" + xmlhttp.responseText)
		else
			alert("The request did not succeed!\n\nThe response status was: " + xmlhttp.status + " " + xmlhttp.statusText + ".");
		}
		
	function sendES(){
		rest("GET","https://cr8s6lopm:ruvfrlsbil@johns-first-starter-1934305931.eu-west-1.bonsai.io/article/external/1",null);
	}
	
	
	window.onload = loadEditor;
</script>

<script>
	$(document).ready(function() {
		$.ajax({
			url: ""https://cr8s6lopm:ruvfrlsbil@johns-first-starter-1934305931.eu-west-1.bonsai.io/article/external/1"
		}).then(function(data) {
		   $('.greeting-id').append(data.id);
		   $('.greeting-content').append(data.content);
		});
	});
</script>



</head>

<body>
<!--
-->
Enter some text in markdown : Notice the full screen and preview buttons at the bottom

<div id="epiceditor"></div>
</div>
then click this button to 
<button type="button" onclick="getit()">get the JSON</button>
<div id="html" class="html">
</div>
<div id="json" class="json">
</div>


<h2>Send as e-mail to john.pickerill@landregistry.gsi.gov.uk:</h2>
<form action="MAILTO:john.pickerill@landregistry.gsi.gov.uk" method="post" enctype="text/plain">

	<input type="submit" value="Send">
		<div class=hide> 
		HTML:<br>
		<input id="mhtml" type="text" name="html" value="your name"><br>
		JSON:<br>
		<input id="mjson" type="text" name="json" value="your email"><br>
		</div>
<input type="reset" value="Reset">
</form>

<h2>Send to Elastic Searcg</h2>
<button type="button" onclick="sendES()">send</button>

<p class="greeting-id">The ID is </p>
<p class="greeting-content">The content is </p>

</body>
</html>